os:
  - Ubuntu
# clone_script:
#   - cmd: >-
#       git clone -q --branch=%APPVEYOR_REPO_BRANCH% https://github.com/%APPVEYOR_REPO_NAME%.git %APPVEYOR_BUILD_FOLDER%
#       && cd %APPVEYOR_BUILD_FOLDER%
#       && git checkout -qf %APPVEYOR_REPO_COMMIT%
#       && git submodule update --init --recursive
install:
  - cd %APPVEYOR_BUILD_FOLDER%
  - git submodule update --init --recursive
  - sudo apt install -y ocl-icd-opencl-dev
platform:
  - x64
configuration:
  - Release
environment:
  matrix:
   - SETARCH: i686
   - SETARCH: x86_64
matrix:
  exclude:
    - platform: Ubuntu
      SETARCH: x86_64
    - platform: x64
      SETARCH: i686
before_build:
  # Setup environment:
  - ps: $env:TOP = $env:APPVEYOR_BUILD_FOLDER
  - ps: $env:TOP
  - echo %TOP%
  # Generate the CTS solution file:
  - cmake -DCMAKE_RUNTIME_OUTPUT_DIRECTORY=./bin
          -DOPENCL_LIBRARIES="OpenCL"
          -H. -Bbuild_win -DARCH=%SETARCH%
build:
  project: build_win\CLConform.sln
  parallel: true
  verbosity: normal